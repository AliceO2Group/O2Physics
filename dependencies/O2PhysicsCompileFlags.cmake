# Copyright 2019-2020 CERN and copyright holders of ALICE O2.
# See https://alice-o2.web.cern.ch/copyright for details of the copyright holders.
# All rights not expressly granted are reserved.
#
# This software is distributed under the terms of the GNU General Public
# License v3 (GPL Version 3), copied verbatim in the file "COPYING".
#
# In applying this license CERN does not waive the privileges and immunities
# granted to it by virtue of its status as an Intergovernmental Organization
# or submit itself to any jurisdiction.

include_guard()

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -Wno-error")
message(STATUS "O2PHYSICS_WARNINGS_AS_ERRORS: ${O2PHYSICS_WARNINGS_AS_ERRORS}")
# Treat warnings as errors.
if(O2PHYSICS_WARNINGS_AS_ERRORS)
  # Set warnings for both gcc and clang.
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} \
-Werror=NSObject-attribute \
-Werror=address \
-Werror=address-of-packed-member \
-Werror=attribute-warning \
-Werror=attributes \
-Werror=bool-operation \
-Werror=builtin-macro-redefined \
-Werror=char-subscripts \
-Werror=class-conversion \
-Werror=comment \
-Werror=conversion-null \
-Werror=cpp \
-Werror=dangling-else \
-Werror=delete-incomplete \
-Werror=delete-non-virtual-dtor \
-Werror=deprecated \
-Werror=deprecated-copy \
-Werror=deprecated-declarations \
-Werror=div-by-zero \
-Werror=empty-body \
-Werror=endif-labels \
-Werror=enum-compare \
-Werror=exceptions \
-Werror=format-extra-args \
-Werror=format-zero-length \
-Werror=frame-address \
-Werror=free-nonheap-object \
-Werror=ignored-attributes \
-Werror=ignored-qualifiers \
-Werror=inaccessible-base \
-Werror=infinite-recursion \
-Werror=int-in-bool-context \
-Werror=int-to-pointer-cast \
-Werror=invalid-offsetof \
-Werror=logical-not-parentheses \
-Werror=main \
-Werror=memset-transposed-args \
-Werror=misleading-indentation \
-Werror=mismatched-new-delete \
-Werror=missing-field-initializers \
-Werror=narrowing \
-Werror=noexcept-type \
-Werror=nonnull \
-Werror=odr \
-Werror=parentheses \
-Werror=pessimizing-move \
-Werror=pointer-compare \
-Werror=pragmas \
-Werror=psabi \
-Werror=range-loop-construct \
-Werror=redundant-move \
-Werror=reorder \
-Werror=return-type \
-Werror=sequence-point \
-Werror=shift-count-negative \
-Werror=shift-count-overflow \
-Werror=sizeof-array-argument \
-Werror=sizeof-array-div \
-Werror=sizeof-pointer-div \
-Werror=sizeof-pointer-memaccess \
-Werror=string-compare \
-Werror=switch \
-Werror=switch-bool \
-Werror=tautological-compare \
-Werror=trigraphs \
-Werror=uninitialized \
-Werror=unknown-pragmas \
-Werror=unused \
-Werror=unused-but-set-parameter \
-Werror=unused-but-set-variable \
-Werror=unused-function \
-Werror=unused-label \
-Werror=unused-parameter \
-Werror=unused-result \
-Werror=unused-value \
-Werror=unused-variable \
-Werror=varargs \
-Werror=vexing-parse \
")
  # Add warnings for clang only.
  if(APPLE)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} \
-Werror=#pragma-messages \
-Werror=#warnings \
-Werror=CFString-literal \
-Werror=CL4 \
-Werror=IndependentClass-attribute \
-Werror=absolute-value \
-Werror=abstract-final-class \
-Werror=address-of-temporary \
-Werror=aix-compat \
-Werror=align-mismatch \
-Werror=alloca-with-align-alignof \
-Werror=always-inline-coroutine \
-Werror=ambiguous-delete \
-Werror=ambiguous-ellipsis \
-Werror=ambiguous-macro \
-Werror=ambiguous-member-template \
-Werror=ambiguous-reversed-operator \
-Werror=analyzer-incompatible-plugin \
-Werror=anon-enum-enum-conversion \
-Werror=anonymous-pack-parens \
-Werror=arc \
-Werror=arc-bridge-casts-disallowed-in-nonarc \
-Werror=arc-non-pod-memaccess \
-Werror=arc-performSelector-leaks \
-Werror=arc-retain-cycles \
-Werror=arc-unsafe-retained-assign \
-Werror=argument-outside-range \
-Werror=argument-undefined-behaviour \
-Werror=array-bounds \
-Werror=array-parameter \
-Werror=asm \
-Werror=asm-operand-widths \
-Werror=assume \
-Werror=atimport-in-framework-header \
-Werror=atomic-access \
-Werror=atomic-alignment \
-Werror=atomic-memory-ordering \
-Werror=atomic-property-with-user-defined-accessor \
-Werror=attribute-packed-for-bitfield \
-Werror=auto-disable-vptr-sanitizer \
-Werror=auto-storage-class \
-Werror=auto-var-id \
-Werror=availability \
-Werror=avr-rtlib-linking-quirks \
-Werror=backend-plugin \
-Werror=backslash-newline-escape \
-Werror=binding-in-condition \
-Werror=bitfield-constant-conversion \
-Werror=bitfield-width \
-Werror=bitwise-conditional-parentheses \
-Werror=bitwise-instead-of-logical \
-Werror=bitwise-op-parentheses \
-Werror=block-capture-autoreleasing \
-Werror=bool-conversion \
-Werror=bool-conversions \
-Werror=braced-scalar-init \
-Werror=branch-protection \
-Werror=bridge-cast \
-Werror=builtin-assume-aligned-alignment \
-Werror=builtin-memcpy-chk-size \
-Werror=builtin-requires-header \
-Werror=call-to-pure-virtual-from-ctor-dtor \
-Werror=called-once-parameter \
-Werror=cast-calling-convention \
-Werror=cast-of-sel-type \
-Werror=cast-qual-unrelated \
-Werror=clang-cl-pch \
-Werror=class-varargs \
-Werror=cmse-union-leak \
-Werror=comments \
-Werror=compare-distinct-pointer-types \
-Werror=compound-token-split \
-Werror=compound-token-split-by-macro \
-Werror=concepts-ts-compat \
-Werror=conditional-type-mismatch \
-Werror=config-macros \
-Werror=constant-conversion \
-Werror=constant-evaluated \
-Werror=constant-logical-operand \
-Werror=constexpr-not-const \
-Werror=conversion \
-Werror=coroutine \
-Werror=coroutine-missing-unhandled-exception \
-Werror=ctu \
-Werror=cuda-compat \
-Werror=cxx-attribute-extension \
-Werror=dangling \
-Werror=dangling-field \
-Werror=dangling-gsl \
-Werror=dangling-initializer-list \
-Werror=darwin-sdk-settings \
-Werror=dealloc-in-category \
-Werror=debug-compression-unavailable \
-Werror=defaulted-function-deleted \
-Werror=delegating-ctor-cycles \
-Werror=delete-abstract-non-virtual-dtor \
-Werror=delete-non-abstract-non-virtual-dtor \
-Werror=deprecate-lax-vec-conv-all \
-Werror=deprecated-altivec-src-compat \
-Werror=deprecated-anon-enum-enum-conversion \
-Werror=deprecated-array-compare \
-Werror=deprecated-attributes \
-Werror=deprecated-builtins \
-Werror=deprecated-comma-subscript \
-Werror=deprecated-copy-with-user-provided-copy \
-Werror=deprecated-coroutine \
-Werror=deprecated-enum-compare \
-Werror=deprecated-enum-compare-conditional \
-Werror=deprecated-enum-enum-conversion \
-Werror=deprecated-enum-float-conversion \
-Werror=deprecated-experimental-coroutine \
-Werror=deprecated-increment-bool \
-Werror=deprecated-non-prototype \
-Werror=deprecated-objc-isa-usage \
-Werror=deprecated-objc-pointer-introspection \
-Werror=deprecated-objc-pointer-introspection-performSelector \
-Werror=deprecated-pragma \
-Werror=deprecated-register \
-Werror=deprecated-static-analyzer-flag \
-Werror=deprecated-type \
-Werror=deprecated-volatile \
-Werror=deprecated-writable-strings \
-Werror=distributed-object-modifiers \
-Werror=division-by-zero \
-Werror=dll-attribute-on-redeclaration \
-Werror=dllexport-explicit-instantiation-decl \
-Werror=dllimport-static-field-def \
-Werror=dtor-name \
-Werror=dtor-typedef \
-Werror=duplicate-decl-specifier \
-Werror=duplicate-protocol \
-Werror=dynamic-class-memaccess \
-Werror=dynamic-exception-spec \
-Werror=elaborated-enum-base \
-Werror=elaborated-enum-class \
-Werror=empty-decomposition \
-Werror=empty-init-stmt \
-Werror=encode-type \
-Werror=enum-compare-conditional \
-Werror=enum-compare-switch \
-Werror=enum-conversion \
-Werror=enum-enum-conversion \
-Werror=enum-float-conversion \
-Werror=enum-too-large \
-Werror=excess-initializers \
-Werror=expansion-to-defined \
-Werror=explicit-initialize-call \
-Werror=export-unnamed \
-Werror=export-using-directive \
-Werror=extern-c-compat \
-Werror=extern-initializer \
-Werror=extra-qualification \
-Werror=extra-tokens \
-Werror=final-dtor-non-final-class \
-Werror=final-macro \
-Werror=fixed-point-overflow \
-Werror=flag-enum \
-Werror=for-loop-analysis \
-Werror=format \
-Werror=format-insufficient-args \
-Werror=format-invalid-specifier \
-Werror=format-security \
-Werror=format=2 \
-Werror=fortify-source \
-Werror=frame-larger-than \
-Werror=frame-larger-than= \
-Werror=framework-include-private-from-public \
-Werror=function-def-in-objc-container \
-Werror=function-multiversion \
-Werror=fuse-ld-path \
-Werror=gcc-compat \
-Werror=global-isel \
-Werror=gnu \
-Werror=gnu-alignof-expression \
-Werror=gnu-array-member-paren-init \
-Werror=gnu-designator \
-Werror=gnu-folding-constant \
-Werror=gnu-inline-cpp-without-extern \
-Werror=gnu-null-pointer-arithmetic \
-Werror=gnu-static-float-init \
-Werror=gnu-string-literal-operator-template \
-Werror=gnu-variable-sized-type-not-at-end \
-Werror=gpu-maybe-wrong-side \
-Werror=header-guard \
-Werror=hip-only \
-Werror=hlsl-extensions \
-Werror=ignored-availability-without-sdk-settings \
-Werror=ignored-optimization-argument \
-Werror=ignored-pragma-intrinsic \
-Werror=ignored-pragmas \
-Werror=ignored-reference-qualifiers \
-Werror=implicit \
-Werror=implicit-const-int-float-conversion \
-Werror=implicit-conversion-floating-point-to-bool \
-Werror=implicit-exception-spec-mismatch \
-Werror=implicit-fixed-point-conversion \
-Werror=implicit-float-conversion \
-Werror=implicit-function-declaration \
-Werror=implicit-int \
-Werror=implicit-int-float-conversion \
-Werror=implicitly-unsigned-literal \
-Werror=include-next-absolute-path \
-Werror=include-next-outside-header \
-Werror=incompatible-exception-spec \
-Werror=incompatible-function-pointer-types \
-Werror=incompatible-library-redeclaration \
-Werror=incompatible-ms-struct \
-Werror=incompatible-pointer-types \
-Werror=incompatible-pointer-types-discards-qualifiers \
-Werror=incompatible-property-type \
-Werror=incompatible-sysroot \
-Werror=incomplete-framework-module-declaration \
-Werror=incomplete-implementation \
-Werror=incomplete-module \
-Werror=incomplete-setjmp-declaration \
-Werror=incomplete-umbrella \
-Werror=inconsistent-dllimport \
-Werror=inconsistent-missing-override \
-Werror=increment-bool \
-Werror=initializer-overrides \
-Werror=injected-class-name \
-Werror=inline-asm \
-Werror=inline-namespace-reopened-noninline \
-Werror=inline-new-delete \
-Werror=instantiation-after-specialization \
-Werror=int-conversion \
-Werror=int-conversions \
-Werror=int-to-void-pointer-cast \
-Werror=integer-overflow \
-Werror=interrupt-service-routine \
-Werror=invalid-command-line-argument \
-Werror=invalid-constexpr \
-Werror=invalid-iboutlet \
-Werror=invalid-initializer-from-system-header \
-Werror=invalid-ios-deployment-target \
-Werror=invalid-no-builtin-names \
-Werror=invalid-noreturn \
-Werror=invalid-or-nonexistent-directory \
-Werror=invalid-partial-specialization \
-Werror=invalid-pp-token \
-Werror=invalid-source-encoding \
-Werror=invalid-token-paste \
-Werror=jump-seh-finally \
-Werror=keyword-compat \
-Werror=knr-promoted-parameter \
-Werror=large-by-value-copy \
-Werror=linker-warnings \
-Werror=literal-conversion \
-Werror=literal-range \
-Werror=local-type-template-args \
-Werror=logical-op-parentheses \
-Werror=macro-redefined \
-Werror=main-return-type \
-Werror=malformed-warning-check \
-Werror=many-braces-around-scalar-init \
-Werror=max-unsigned-zero \
-Werror=memsize-comparison \
-Werror=microsoft \
-Werror=microsoft-abstract \
-Werror=microsoft-anon-tag \
-Werror=microsoft-cast \
-Werror=microsoft-const-init \
-Werror=microsoft-default-arg-redefinition \
-Werror=microsoft-drectve-section \
-Werror=microsoft-enum-forward-reference \
-Werror=microsoft-exception-spec \
-Werror=microsoft-exists \
-Werror=microsoft-explicit-constructor-call \
-Werror=microsoft-extra-qualification \
-Werror=microsoft-goto \
-Werror=microsoft-inaccessible-base \
-Werror=microsoft-include \
-Werror=microsoft-mutable-reference \
-Werror=microsoft-pure-definition \
-Werror=microsoft-sealed \
-Werror=microsoft-static-assert \
-Werror=microsoft-template \
-Werror=microsoft-template-shadow \
-Werror=microsoft-union-member-reference \
-Werror=microsoft-unqualified-friend \
-Werror=microsoft-using-decl \
-Werror=microsoft-void-pseudo-dtor \
-Werror=misexpect \
-Werror=mismatched-parameter-types \
-Werror=mismatched-return-types \
-Werror=mismatched-tags \
-Werror=missing-braces \
-Werror=missing-constinit \
-Werror=missing-declarations \
-Werror=missing-exception-spec \
-Werror=missing-method-return-type \
-Werror=missing-noescape \
-Werror=missing-prototype-for-cc \
-Werror=missing-selector-name \
-Werror=missing-sysroot \
-Werror=misspelled-assumption \
-Werror=module-conflict \
-Werror=module-file-config-mismatch \
-Werror=module-file-extension \
-Werror=module-import-in-extern-c \
-Werror=modules-ambiguous-internal-linkage \
-Werror=modules-import-nested-redundant \
-Werror=move \
-Werror=msvc-include \
-Werror=msvc-not-found \
-Werror=multichar \
-Werror=multiple-move-vbase \
-Werror=new-returns-null \
-Werror=noderef \
-Werror=non-c-typedef-for-linkage \
-Werror=non-gcc \
-Werror=non-literal-null-conversion \
-Werror=non-pod-varargs \
-Werror=non-power-of-two-alignment \
-Werror=nonportable-include-path \
-Werror=nonportable-vector-initialization \
-Werror=nontrivial-memaccess \
-Werror=nsconsumed-mismatch \
-Werror=nsreturns-mismatch \
-Werror=null-arithmetic \
-Werror=null-character \
-Werror=null-conversion \
-Werror=null-dereference \
-Werror=null-pointer-arithmetic \
-Werror=null-pointer-subtraction \
-Werror=nullability \
-Werror=nullability-completeness \
-Werror=nullability-completeness-on-arrays \
-Werror=nullability-declspec \
-Werror=nullability-inferred-on-nested-type \
-Werror=objc-autosynthesis-property-ivar-name-match \
-Werror=objc-bool-constant-conversion \
-Werror=objc-boxing \
-Werror=objc-circular-container \
-Werror=objc-cocoa-api \
-Werror=objc-designated-initializers \
-Werror=objc-dictionary-duplicate-keys \
-Werror=objc-flexible-array \
-Werror=objc-forward-class-redefinition \
-Werror=objc-literal-compare \
-Werror=objc-literal-conversion \
-Werror=objc-macro-redefinition \
-Werror=objc-method-access \
-Werror=objc-missing-super-calls \
-Werror=objc-multiple-method-names \
-Werror=objc-noncopy-retain-block-property \
-Werror=objc-nonunified-exceptions \
-Werror=objc-property-implementation \
-Werror=objc-property-implicit-mismatch \
-Werror=objc-property-matches-cocoa-ownership-rule \
-Werror=objc-property-no-attribute \
-Werror=objc-property-synthesis \
-Werror=objc-protocol-method-implementation \
-Werror=objc-protocol-property-synthesis \
-Werror=objc-protocol-qualifiers \
-Werror=objc-readonly-with-setter-property \
-Werror=objc-redundant-api-use \
-Werror=objc-redundant-literal-use \
-Werror=objc-root-class \
-Werror=objc-signed-char-bool \
-Werror=objc-signed-char-bool-implicit-float-conversion \
-Werror=objc-string-compare \
-Werror=objc-string-concatenation \
-Werror=objc-unsafe-perform-selector \
-Werror=opencl-unsupported-rgba \
-Werror=openmp \
-Werror=openmp-51-extensions \
-Werror=openmp-clauses \
-Werror=openmp-loop-form \
-Werror=openmp-mapping \
-Werror=openmp-target \
-Werror=option-ignored \
-Werror=ordered-compare-function-pointers \
-Werror=out-of-line-declaration \
-Werror=out-of-scope-function \
-Werror=overloaded-shift-op-parentheses \
-Werror=overloaded-virtual \
-Werror=override-init \
-Werror=override-module \
-Werror=overriding-t-option \
-Werror=parentheses-equality \
-Werror=partial-availability \
-Werror=pass-failed \
-Werror=pch-date-time \
-Werror=pedantic-macros \
-Werror=pointer-arith \
-Werror=pointer-bool-conversion \
-Werror=pointer-integer-compare \
-Werror=pointer-sign \
-Werror=pointer-to-enum-cast \
-Werror=pointer-to-int-cast \
-Werror=pointer-type-mismatch \
-Werror=potentially-direct-selector \
-Werror=potentially-evaluated-expression \
-Werror=pragma-clang-attribute \
-Werror=pragma-once-outside-header \
-Werror=pragma-pack \
-Werror=pragma-system-header-outside-header \
-Werror=predefined-identifier-outside-function \
-Werror=private-extern \
-Werror=private-header \
-Werror=private-module \
-Werror=profile-instr-out-of-date \
-Werror=profile-instr-unprofiled \
-Werror=property-access-dot-syntax \
-Werror=property-attribute-mismatch \
-Werror=protocol \
-Werror=protocol-property-synthesis-ambiguity \
-Werror=qualified-void-return-type \
-Werror=readonly-iboutlet-property \
-Werror=receiver-expr \
-Werror=receiver-forward-class \
-Werror=redeclared-class-member \
-Werror=redundant-consteval-if \
-Werror=register \
-Werror=reinterpret-base-class \
-Werror=reorder-ctor \
-Werror=reorder-init-list \
-Werror=requires-super-attribute \
-Werror=reserved-user-defined-literal \
-Werror=restrict-expansion \
-Werror=return-stack-address \
-Werror=return-type-c-linkage \
-Werror=rewrite-not-bool \
-Werror=rtti \
-Werror=sarif-format-unstable \
-Werror=section \
-Werror=self-assign \
-Werror=self-assign-field \
-Werror=self-assign-overloaded \
-Werror=self-move \
-Werror=semicolon-before-method-body \
-Werror=sentinel \
-Werror=serialized-diagnostics \
-Werror=shadow \
-Werror=shadow-all \
-Werror=shadow-ivar \
-Werror=shift-negative-value \
-Werror=shift-op-parentheses \
-Werror=shift-overflow \
-Werror=signed-unsigned-wchar \
-Werror=sizeof-array-decay \
-Werror=slash-u-filename \
-Werror=slh-asm-goto \
-Werror=sometimes-uninitialized \
-Werror=source-mgr \
-Werror=source-uses-openmp \
-Werror=stack-exhausted \
-Werror=stack-protector \
-Werror=static-float-init \
-Werror=static-in-inline \
-Werror=static-inline-explicit-instantiation \
-Werror=static-local-in-inline \
-Werror=static-self-init \
-Werror=stdlibcxx-not-found \
-Werror=strict-potentially-direct-selector \
-Werror=strict-prototypes \
-Werror=string-concatenation \
-Werror=string-plus-char \
-Werror=string-plus-int \
-Werror=strlcpy-strlcat-size \
-Werror=strncat-size \
-Werror=suspicious-bzero \
-Werror=suspicious-memaccess \
-Werror=swift-name-attribute \
-Werror=sync-fetch-and-nand-semantics-changed \
-Werror=target-clones-mixed-specifiers \
-Werror=tautological-bitwise-compare \
-Werror=tautological-constant-compare \
-Werror=tautological-constant-out-of-range-compare \
-Werror=tautological-objc-bool-compare \
-Werror=tautological-overlap-compare \
-Werror=tautological-pointer-compare \
-Werror=tautological-undefined-compare \
-Werror=tcb-enforcement \
-Werror=tentative-definition-incomplete-type \
-Werror=type-safety \
-Werror=typedef-redefinition \
-Werror=typename-missing \
-Werror=unable-to-open-stats-file \
-Werror=unaligned-qualifier-implicit-cast \
-Werror=unavailable-declarations \
-Werror=undefined-bool-conversion \
-Werror=undefined-inline \
-Werror=undefined-internal \
-Werror=undefined-var-template \
-Werror=underaligned-exception-object \
-Werror=unevaluated-expression \
-Werror=unguarded-availability \
-Werror=unguarded-availability-new \
-Werror=unicode \
-Werror=unicode-homoglyph \
-Werror=unicode-whitespace \
-Werror=unicode-zero-width \
-Werror=uninitialized-const-reference \
-Werror=unknown-argument \
-Werror=unknown-assumption \
-Werror=unknown-attributes \
-Werror=unknown-cuda-version \
-Werror=unknown-directives \
-Werror=unknown-escape-sequence \
-Werror=unknown-sanitizers \
-Werror=unknown-warning-option \
-Werror=unnamed-type-template-args \
-Werror=unneeded-internal-declaration \
-Werror=unqualified-std-cast-call \
-Werror=unreachable-code \
-Werror=unreachable-code-aggressive \
-Werror=unreachable-code-generic-assoc \
-Werror=unsequenced \
-Werror=unsupported-abi \
-Werror=unsupported-abs \
-Werror=unsupported-availability-guard \
-Werror=unsupported-cb \
-Werror=unsupported-floating-point-opt \
-Werror=unsupported-friend \
-Werror=unsupported-gpopt \
-Werror=unsupported-nan \
-Werror=unsupported-target-opt \
-Werror=unsupported-visibility \
-Werror=unusable-partial-specialization \
-Werror=unused-command-line-argument \
-Werror=unused-comparison \
-Werror=unused-const-variable \
-Werror=unused-getter-return-value \
-Werror=unused-lambda-capture \
-Werror=unused-local-typedef \
-Werror=unused-private-field \
-Werror=unused-property-ivar \
-Werror=unused-volatile-lvalue \
-Werror=user-defined-literals \
-Werror=user-defined-warnings \
-Werror=variadic-macros \
-Werror=vec-elem-size \
-Werror=visibility \
-Werror=void-pointer-to-enum-cast \
-Werror=void-pointer-to-int-cast \
-Werror=void-ptr-dereference \
-Werror=wasm-exception-spec \
-Werror=writable-strings \
-Werror=write-strings \
-Werror=xor-used-as-pow \
")
  # Add warnings for gcc only.
  elseif(UNIX)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} \
-Werror=aggressive-loop-optimizations \
-Werror=analyzer-double-fclose \
-Werror=analyzer-double-free \
-Werror=analyzer-exposure-through-output-file \
-Werror=analyzer-file-leak \
-Werror=analyzer-free-of-non-heap \
-Werror=analyzer-malloc-leak \
-Werror=analyzer-mismatching-deallocation \
-Werror=analyzer-null-argument \
-Werror=analyzer-null-dereference \
-Werror=analyzer-possible-null-argument \
-Werror=analyzer-possible-null-dereference \
-Werror=analyzer-shift-count-negative \
-Werror=analyzer-shift-count-overflow \
-Werror=analyzer-stale-setjmp-buffer \
-Werror=analyzer-tainted-allocation-size \
-Werror=analyzer-tainted-array-index \
-Werror=analyzer-tainted-divisor \
-Werror=analyzer-tainted-offset \
-Werror=analyzer-tainted-size \
-Werror=analyzer-unsafe-call-within-signal-handler \
-Werror=analyzer-use-after-free \
-Werror=analyzer-use-of-pointer-in-stale-stack-frame \
-Werror=analyzer-use-of-uninitialized-value \
-Werror=analyzer-write-to-const \
-Werror=analyzer-write-to-string-literal \
-Werror=array-bounds=1 \
-Werror=array-compare \
-Werror=array-parameter=2 \
-Werror=bool-compare \
-Werror=builtin-declaration-mismatch \
-Werror=cannot-profile \
-Werror=cast-function-type \
-Werror=catch-value=1 \
-Werror=class-memaccess \
-Werror=clobbered \
-Werror=coverage-invalid-line-number \
-Werror=coverage-mismatch \
-Werror=dangling-pointer=2 \
-Werror=format-contains-nul \
-Werror=format-diag \
-Werror=format-overflow=1 \
-Werror=format-truncation=1 \
-Werror=format=1 \
-Werror=if-not-aligned \
-Werror=implicit-fallthrough=3 \
-Werror=inherited-variadic-ctor \
-Werror=init-list-lifetime \
-Werror=init-self \
-Werror=interference-size \
-Werror=invalid-memory-model \
-Werror=literal-suffix \
-Werror=lto-type-mismatch \
-Werror=maybe-uninitialized \
-Werror=memset-elt-size \
-Werror=mismatched-dealloc \
-Werror=missing-attributes \
-Werror=missing-profile \
-Werror=missing-requires \
-Werror=missing-template-keyword \
-Werror=multistatement-macros \
-Werror=non-template-friend \
-Werror=nonnull-compare \
-Werror=openmp-simd \
-Werror=overflow \
-Werror=packed-bitfield-compat \
-Werror=packed-not-aligned \
-Werror=pmf-conversions \
-Werror=prio-ctor-dtor \
-Werror=restrict \
-Werror=return-local-addr \
-Werror=scalar-storage-order \
-Werror=sized-deallocation \
-Werror=strict-aliasing=3 \
-Werror=strict-overflow=1 \
-Werror=stringop-overflow=2 \
-Werror=stringop-overread \
-Werror=stringop-truncation \
-Werror=subobject-linkage \
-Werror=switch-outside-range \
-Werror=switch-unreachable \
-Werror=sync-nand \
-Werror=terminate \
-Werror=tsan \
-Werror=type-limits \
-Werror=unused-local-typedefs \
-Werror=use-after-free=2 \
-Werror=virtual-move-assign \
-Werror=vla-parameter \
-Werror=volatile-register-var \
-Werror=zero-length-bounds \
")
  endif()
endif()

IF (ENABLE_TIMETRACE)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -ftime-trace")
ENDIF()

set(CMAKE_CXX_FLAGS_COVERAGE "-g -O2 -fprofile-arcs -ftest-coverage")
set(CMAKE_C_FLAGS_COVERAGE "${CMAKE_CXX_FLAGS_COVERAGE}")
set(CMAKE_Fortran_FLAGS_COVERAGE "-g -O2 -fprofile-arcs -ftest-coverage")
set(CMAKE_LINK_FLAGS_COVERAGE "--coverage -fprofile-arcs  -fPIC")

MARK_AS_ADVANCED(
    CMAKE_CXX_FLAGS_COVERAGE
    CMAKE_C_FLAGS_COVERAGE
    CMAKE_Fortran_FLAGS_COVERAGE
    CMAKE_LINK_FLAGS_COVERAGE)

#Check the compiler and set the compile and link flags
IF (NOT CMAKE_BUILD_TYPE)
  Message(STATUS "Set BuildType to DEBUG")
  set(CMAKE_BUILD_TYPE RELWITHDEBINFO)
ENDIF (NOT CMAKE_BUILD_TYPE)

IF(ENABLE_CASSERT) #For the CI, we want to have <cassert> assertions enabled
    set(CMAKE_CXX_FLAGS_RELEASE "-O2")
    set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g")
ELSE()
    set(CMAKE_CXX_FLAGS_RELEASE "-O2 -DNDEBUG")
    set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG")
    if (CMAKE_BUILD_TYPE STREQUAL "RELEASE" OR CMAKE_BUILD_TYPE STREQUAL "RELWITHDEBINFO")
      set(FAIR_MIN_SEVERITY "info")
    endif()
ENDIF()
set(CMAKE_C_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE}")
set(CMAKE_Fortran_FLAGS_RELEASE "-O2")
set(CMAKE_Fortran_FLAGS_RELWITHDEBINFO "-O2 -g")
# make sure Debug build not optimized (does not seem to work without CACHE + FORCE)
set(CMAKE_CXX_FLAGS_DEBUG "-g -O0" CACHE STRING "Debug mode build flags" FORCE)
set(CMAKE_C_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG}" CACHE STRING "Debug mode build flags" FORCE)
set(CMAKE_Fortran_FLAGS_DEBUG "-g -O0" CACHE STRING "Debug mode build flags" FORCE)

if(APPLE)
elseif(UNIX)
  set(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,--no-undefined") # avoid undefined in our libs
endif()

message(STATUS "Using build type: ${CMAKE_BUILD_TYPE} - CXXFLAGS: ${CMAKE_CXX_FLAGS} ${CMAKE_CXX_FLAGS_${CMAKE_BUILD_TYPE}}")
